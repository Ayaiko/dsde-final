<mxfile host="app.diagrams.net">
  <diagram name="AI/ML Pipeline - Detailed" id="ai-pipeline">
    <mxGraphModel dx="1434" dy="790" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        
        <!-- Title -->
        <mxCell id="title" value="Bangkok Traffy ML Pipeline - AI/ML Workflow" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontSize=18;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="400" y="10" width="800" height="35" as="geometry"/>
        </mxCell>
        
        <!-- DATA PREPARATION SWIMLANE -->
        <mxCell id="dataPrepGroup" value="DATA PREPARATION" style="swimlane;fillColor=#E3F2FD;strokeColor=#1976D2;strokeWidth=2;fontSize=13;fontStyle=1;startSize=30" vertex="1" parent="1">
          <mxGeometry x="60" y="60" width="1480" height="140" as="geometry"/>
        </mxCell>
        
        <mxCell id="loaddata" value="Load Dataset&#xa;traffy_weather_final.csv" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#1976D2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="dataPrepGroup">
          <mxGeometry x="30" y="45" width="140" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="splitxy" value="Split X/y&#xa;Features/Targets" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#1976D2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="dataPrepGroup">
          <mxGeometry x="190" y="45" width="120" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="dropfeatures" value="Drop Columns&#xa;timestamp, coords" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#1976D2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="dataPrepGroup">
          <mxGeometry x="330" y="45" width="120" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="traintestsplit" value="Train/Test Split&#xa;80/20 stratified" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#1976D2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="dataPrepGroup">
          <mxGeometry x="470" y="45" width="130" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="featurenames" value="Store Features&#xa;For interpretation" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#1976D2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="dataPrepGroup">
          <mxGeometry x="620" y="45" width="120" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="validation" value="3-Fold CV&#xa;Validation" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#1976D2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="dataPrepGroup">
          <mxGeometry x="760" y="45" width="100" height="70" as="geometry"/>
        </mxCell>
        
        <!-- TRAINING LOOP SWIMLANE -->
        <mxCell id="trainingLoopGroup" value="TRAINING LOOP (Per Type)" style="swimlane;fillColor=#FFF3E0;strokeColor=#E65100;strokeWidth=2;fontSize=13;fontStyle=1;startSize=30" vertex="1" parent="1">
          <mxGeometry x="60" y="220" width="1480" height="180" as="geometry"/>
        </mxCell>
        
        <mxCell id="selecttype" value="Select Type&#xa;Iterate all" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#E65100;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="trainingLoopGroup">
          <mxGeometry x="30" y="45" width="100" height="65" as="geometry"/>
        </mxCell>
        
        <mxCell id="checksample" value="≥50&#xa;samples?" style="rhombus;whiteSpace=wrap;fillColor=#FFF9C4;strokeColor=#F57F17;strokeWidth=2;fontSize=11;" vertex="1" parent="trainingLoopGroup">
          <mxGeometry x="150" y="40" width="90" height="75" as="geometry"/>
        </mxCell>
        
        <mxCell id="skip" value="Skip&#xa;Type" style="rounded=1;whiteSpace=wrap;fillColor=#FFEBEE;strokeColor=#C62828;strokeWidth=2;fontSize=10;whiteSpace=wrap;" vertex="1" parent="trainingLoopGroup">
          <mxGeometry x="150" y="130" width="90" height="45" as="geometry"/>
        </mxCell>
        
        <mxCell id="checkimbalance" value="Class&#xa;Ratio?" style="rhombus;whiteSpace=wrap;fillColor=#FFF9C4;strokeColor=#F57F17;strokeWidth=2;fontSize=11;" vertex="1" parent="trainingLoopGroup">
          <mxGeometry x="260" y="40" width="80" height="75" as="geometry"/>
        </mxCell>
        
        <mxCell id="smote" value="SMOTE" style="rounded=1;whiteSpace=wrap;fillColor=#E8F5E9;strokeColor=#2E7D32;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="trainingLoopGroup">
          <mxGeometry x="360" y="45" width="80" height="30" as="geometry"/>
        </mxCell>
        
        <mxCell id="oversample" value="Oversample" style="rounded=1;whiteSpace=wrap;fillColor=#E8F5E9;strokeColor=#2E7D32;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="trainingLoopGroup">
          <mxGeometry x="360" y="85" width="80" height="30" as="geometry"/>
        </mxCell>
        
        <mxCell id="hyperparams" value="Hyperparams&#xa;Search Space" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#E65100;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="trainingLoopGroup">
          <mxGeometry x="460" y="45" width="110" height="65" as="geometry"/>
        </mxCell>
        
        <mxCell id="randomsearch" value="RandomizedSearchCV&#xa;5 iter, 3-fold" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#E65100;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="trainingLoopGroup">
          <mxGeometry x="590" y="45" width="140" height="65" as="geometry"/>
        </mxCell>
        
        <mxCell id="trainrf" value="Train RF&#xa;Best params" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#E65100;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="trainingLoopGroup">
          <mxGeometry x="750" y="45" width="100" height="65" as="geometry"/>
        </mxCell>
        
        <mxCell id="predict" value="Predict&#xa;Test Set" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#E65100;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="trainingLoopGroup">
          <mxGeometry x="870" y="45" width="90" height="65" as="geometry"/>
        </mxCell>
        
        <!-- EVALUATION SWIMLANE -->
        <mxCell id="evaluationGroup" value="EVALUATION &amp; RESULTS" style="swimlane;fillColor=#F3E5F5;strokeColor=#7B1FA2;strokeWidth=2;fontSize=13;fontStyle=1;startSize=30" vertex="1" parent="1">
          <mxGeometry x="60" y="420" width="1480" height="140" as="geometry"/>
        </mxCell>
        
        <mxCell id="calcmetrics" value="Metrics&#xa;Acc, P, R, F1" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#7B1FA2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="evaluationGroup">
          <mxGeometry x="30" y="45" width="100" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="confusionmatrix" value="Confusion&#xa;Matrix" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#7B1FA2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="evaluationGroup">
          <mxGeometry x="150" y="45" width="90" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="featureimportance" value="Feature&#xa;Importance" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#7B1FA2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="evaluationGroup">
          <mxGeometry x="260" y="45" width="100" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="roc" value="ROC-AUC" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#7B1FA2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="evaluationGroup">
          <mxGeometry x="380" y="45" width="80" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="logmetrics" value="Log&#xa;Metrics" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#7B1FA2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="evaluationGroup">
          <mxGeometry x="480" y="45" width="80" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="savemodel" value="Save Model&#xa;(.pkl)" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#7B1FA2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="evaluationGroup">
          <mxGeometry x="580" y="45" width="100" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="nexttype" value="More?" style="rhombus;whiteSpace=wrap;fillColor=#FFF9C4;strokeColor=#F57F17;strokeWidth=2;fontSize=11;" vertex="1" parent="evaluationGroup">
          <mxGeometry x="700" y="45" width="80" height="70" as="geometry"/>
        </mxCell>
        
        <mxCell id="finalize" value="Aggregate&#xa;Results" style="rounded=1;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#7B1FA2;strokeWidth=2;fontSize=11;whiteSpace=wrap;" vertex="1" parent="evaluationGroup">
          <mxGeometry x="800" y="45" width="100" height="70" as="geometry"/>
        </mxCell>
        
        <!-- OUTPUT SWIMLANE -->
        <mxCell id="outputGroup" value="OUTPUTS" style="swimlane;fillColor=#E8F5E9;strokeColor=#2E7D32;strokeWidth=2;fontSize=13;fontStyle=1;startSize=30" vertex="1" parent="1">
          <mxGeometry x="60" y="580" width="740" height="120" as="geometry"/>
        </mxCell>
        
        <mxCell id="modelsout" value="Models&#xa;(.pkl files)" style="rounded=0;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#2E7D32;strokeWidth=2;fontSize=11;fontStyle=1;whiteSpace=wrap;" vertex="1" parent="outputGroup">
          <mxGeometry x="30" y="45" width="120" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="summarycsv" value="Summary CSV&#xa;Metrics per type" style="rounded=0;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#2E7D32;strokeWidth=2;fontSize=11;fontStyle=1;whiteSpace=wrap;" vertex="1" parent="outputGroup">
          <mxGeometry x="170" y="45" width="130" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="featureimp" value="Feature&#xa;Importance" style="rounded=0;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#2E7D32;strokeWidth=2;fontSize=11;fontStyle=1;whiteSpace=wrap;" vertex="1" parent="outputGroup">
          <mxGeometry x="320" y="45" width="110" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="logs" value="Logs" style="rounded=0;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#2E7D32;strokeWidth=2;fontSize=11;fontStyle=1;whiteSpace=wrap;" vertex="1" parent="outputGroup">
          <mxGeometry x="450" y="45" width="80" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="visualization" value="Streamlit&#xa;Dashboard" style="rounded=0;whiteSpace=wrap;fillColor=#FFFFFF;strokeColor=#2E7D32;strokeWidth=2;fontSize=11;fontStyle=1;whiteSpace=wrap;" vertex="1" parent="outputGroup">
          <mxGeometry x="550" y="45" width="110" height="60" as="geometry"/>
        </mxCell>
        
        <!-- ML TECHNIQUES INFO BOX -->
        <mxCell id="mlinfo" value="KEY ML TECHNIQUES&#xa;&#xa;• Multi-label: Binary per type&#xa;• Imbalance: SMOTE/Oversample&#xa;• Tuning: RandomizedSearchCV&#xa;• Model: Random Forest&#xa;• Validation: 3-fold CV" style="rounded=0;whiteSpace=wrap;fillColor=#FFF8E1;strokeColor=#FF6F00;strokeWidth=2;fontSize=11;align=left;spacingLeft=15;fontStyle=0;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="820" y="580" width="360" height="120" as="geometry"/>
        </mxCell>
        
        <!-- MODEL ARCHITECTURE INFO BOX -->
        <mxCell id="archinfo" value="RANDOM FOREST&#xa;&#xa;• Ensemble: Multiple trees&#xa;• Training: Bagging&#xa;• Criterion: Gini impurity&#xa;• Benefits: Robust, feature importance" style="rounded=0;whiteSpace=wrap;fillColor=#E1F5FE;strokeColor=#01579B;strokeWidth=2;fontSize=11;align=left;spacingLeft=15;fontStyle=0;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1200" y="580" width="340" height="120" as="geometry"/>
        </mxCell>
        
        <!-- Main Flow Connections -->
        <mxCell id="flow1" edge="1" parent="1" source="loaddata" target="splitxy">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow2" edge="1" parent="1" source="splitxy" target="dropfeatures">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow3" edge="1" parent="1" source="dropfeatures" target="traintestsplit">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow4" edge="1" parent="1" source="traintestsplit" target="featurenames">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow5" edge="1" parent="1" source="featurenames" target="validation">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow6" edge="1" parent="1" source="validation" target="selecttype">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="910" y="210"/>
              <mxPoint x="140" y="210"/>
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow7" edge="1" parent="1" source="selecttype" target="checksample">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow8" value="&lt; 50" edge="1" parent="1" source="checksample" target="skip">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow9" value="≥ 50" edge="1" parent="1" source="checksample" target="checkimbalance">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow10" value="High&#xa;imbalance" edge="1" parent="1" source="checkimbalance" target="smote">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow11" value="Moderate&#xa;imbalance" edge="1" parent="1" source="checkimbalance" target="oversample">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow12" edge="1" parent="1" source="smote" target="hyperparams">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow13" edge="1" parent="1" source="oversample" target="hyperparams">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="460" y="330"/>
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow14" edge="1" parent="1" source="hyperparams" target="randomsearch">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow15" edge="1" parent="1" source="randomsearch" target="trainrf">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow16" edge="1" parent="1" source="trainrf" target="predict">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow17" edge="1" parent="1" source="predict" target="calcmetrics">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1010" y="410"/>
              <mxPoint x="140" y="410"/>
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow18" edge="1" parent="1" source="calcmetrics" target="confusionmatrix">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow19" edge="1" parent="1" source="confusionmatrix" target="featureimportance">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow20" edge="1" parent="1" source="featureimportance" target="roc">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow21" edge="1" parent="1" source="roc" target="logmetrics">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow22" edge="1" parent="1" source="logmetrics" target="savemodel">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow23" edge="1" parent="1" source="savemodel" target="nexttype">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow24" value="YES" edge="1" parent="1" source="nexttype" target="selecttype">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="800" y="570"/>
              <mxPoint x="40" y="570"/>
              <mxPoint x="40" y="310"/>
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow25" value="NO" edge="1" parent="1" source="nexttype" target="finalize">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow26" edge="1" parent="1" source="finalize" target="summarycsv">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="910" y="570"/>
              <mxPoint x="295" y="570"/>
            </Array>
          </mxGeometry>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
